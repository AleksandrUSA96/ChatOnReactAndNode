(this.webpackJsonpchat__frontend=this.webpackJsonpchat__frontend||[]).push([[0],{10:function(e,t,a){e.exports={rooms__wrapper:"roomList_rooms__wrapper__2fbIP",room__list__header:"roomList_room__list__header__Vm6zH",room__list__wrapper:"roomList_room__list__wrapper__Wpk6H",room__wrapper:"roomList_room__wrapper__60f20",room__name:"roomList_room__name__23j0O",user__list__wrapper:"roomList_user__list__wrapper__2X7zg",opacity__in:"roomList_opacity__in__1a7jA",height__in:"roomList_height__in__11s9U",user__block:"roomList_user__block__i0R3N",chat__wrapper:"roomList_chat__wrapper__2dv1B",button__wrapper:"roomList_button__wrapper__Ux1Af"}},129:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(65),o=a.n(s),c=(a(75),a(8)),_=a(35),i=a.n(_),m=a(19),u=a.n(m),l=a(28),j=a(66),p=a(67),d=a.n(p)()("http://localhost:3001"),b=j.create({baseURL:"https://chat-on-react-and-node-backend.herokuapp.com/"}),O=function(e){return Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.post("entrance",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},f=function(e){d.emit("MESSAGE",e)},h=function(e){d.emit("ROOM:AUTH",e)},x=function(e){d.on("ROOM:SET_ROOMS",(function(t){return e(t)}))},g=function(e){d.on("ROOM:SET_MESSAGES",(function(t){return e(t)}))},S=function(e){d.on("MESSAGE",(function(t){return e(t)}))},E=a(68),v=a.n(E),w=a(2),M=a(1),L=function(e){var t=e.onEntrance,a=e.roomIdFromURL,r=Object(n.useState)(""),s=Object(c.a)(r,2),o=s[0],_=s[1],i=Object(n.useState)(""),m=Object(c.a)(i,2),j=m[0],p=m[1],d=Object(n.useState)(!1),b=Object(c.a)(d,2),f=b[0],h=b[1],x=Object(n.useState)(!1),g=Object(c.a)(x,2),S=g[0],E=g[1],L=Object(w.f)();return Object(n.useEffect)((function(){null!==a&&p(a),S&&Object(l.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),a={name:o,roomId:j},e.next=4,O(a);case 4:t(a),L.push("/roomlist/"+j);case 6:case"end":return e.stop()}}),e)})))()}),[S]),Object(M.jsxs)("div",{className:v.a.entrance__wrapper,children:[Object(M.jsx)("input",{name:"name",type:"text",placeholder:"What's your name?",value:o,onChange:function(e){return _(e.target.value)}}),Object(M.jsx)("input",{name:"room",type:"text",placeholder:"What's a room name?",value:j,onChange:function(e){return p(e.target.value)}}),Object(M.jsx)("button",{disabled:f,onClick:function(){return""!==o.trim()&&""!==j.trim()&&E(!0)},children:f?"Entry...":"Entrance"})]})},y=a(70),A=a(7),I=function(e,t){switch(t.type){case"IS_AUTH":return Object(A.a)(Object(A.a)({},e),{},{isAuth:!0,name:t.payload.name,roomId:t.payload.roomId});case"SET_ROOM_ID_FROM_URL":return Object(A.a)(Object(A.a)({},e),{},{roomIdFromURL:t.payload});case"SWITCH_TO_FALSE":return Object(A.a)(Object(A.a)({},e),{},{isAuth:!1});case"SET_ROOMS":return Object(A.a)(Object(A.a)({},e),{},{roomsList:t.payload});case"SET_MESSAGES":return Object(A.a)(Object(A.a)({},e),{},{messages:t.payload});case"SET_MESSAGE":return Object(A.a)(Object(A.a)({},e),{},{messages:[].concat(Object(y.a)(e.messages),[t.payload])});default:return e}},C=a(10),N=a.n(C),R=function(e){var t=e.user;return Object(M.jsx)("li",{className:N.a.user__block,children:t})},T=a(23),U=function(e){var t=e.room,a=e.onEntrance,r=e.name,s=e.roomId,o=Object(n.useState)(!1),_=Object(c.a)(o,2),i=_[0],m=_[1];return Object(M.jsxs)("div",{className:N.a.room__wrapper,children:[Object(M.jsxs)("h3",{className:N.a.room__name,children:[t.name," (",t.val.length,")"]}),i&&Object(M.jsx)("ol",{className:N.a.user__list__wrapper,children:t.val.map((function(e,t){return Object(M.jsx)(R,{user:e},t)}))}),Object(M.jsxs)("div",{className:N.a.button__wrapper,children:[Object(M.jsx)("button",{onClick:function(){m(!i)},children:"Users of rooms"}),s!==t.name?Object(M.jsx)(T.b,{to:"/roomlist/"+t.name,children:Object(M.jsx)("button",{onClick:function(){return a({name:r,roomId:t.name})},children:"Join"})}):""]})]})},k=a(6),H=a.n(k),F=a(29),G=a.n(F),D=function(e){var t=e.message;return Object(M.jsxs)("div",{style:d.id===t[1]?{alignSelf:"flex-end",display:"flex",flexDirection:"column",alignItems:"flex-end",textAlign:"right"}:{},className:H.a.message,children:[Object(M.jsx)("p",{className:H.a.text__message,children:t[0].text}),Object(M.jsxs)("div",{className:H.a.message__info,children:[Object(M.jsx)("span",{className:H.a.message__sender,children:t[0].user}),Object(M.jsx)("span",{className:H.a.message__sent,children:G()(t[0].date).format("DD.MMM HH:mm")})]})]})},B=function(e){var t=e.state,a=e.setMessageHandler,r=Object(n.useState)(""),s=Object(c.a)(r,2),o=s[0],_=s[1],i=Object(n.useState)(!1),m=Object(c.a)(i,2),u=m[0],l=m[1];return Object(n.useEffect)((function(){var e=G()(),n={user:t.name,text:o,date:e};u&&(f([n,t.roomId]),a([n,d.id]),_(""),l(!1))}),[u]),Object(M.jsxs)("form",{className:H.a.form__message,onSubmit:function(e){return e.preventDefault()},children:[Object(M.jsx)("textarea",{className:H.a.textarea,value:o,onChange:function(e){return _(e.target.value)},name:"chat",id:"chat",cols:"100",rows:"5",children:"''"}),Object(M.jsx)("button",{className:H.a.button__send,onClick:function(){return""!==o.trim()&&l(!0)},children:"Send"})]})},W=function(e){var t=e.state,a=e.setMessageHandler,r=Object(n.useRef)(null);return Object(n.useEffect)((function(){r.current.scrollTo(0,999999)}),[t.messages]),Object(M.jsxs)("div",{className:H.a.chat__wrapper,children:[Object(M.jsx)("div",{ref:r,className:H.a.messages,children:0!==t.messages.length?t.messages.map((function(e,t){return Object(M.jsx)(D,{message:e},t)})):""}),Object(M.jsx)(B,{state:t,setMessageHandler:a})]})},z=function(e){var t=e.state,a=e.onEntrance,n=e.setMessageHandler;return Object(M.jsxs)("div",{className:N.a.rooms__wrapper,children:[Object(M.jsxs)("div",{className:N.a.room__list__wrapper,children:[Object(M.jsx)("h3",{className:N.a.room__list__header,children:"Room List"}),Object(M.jsx)("hr",{}),t.roomsList.length&&t.roomsList.map((function(e,n){return Object(M.jsx)(U,{room:e,onEntrance:a,name:t.name,roomId:t.roomId},n)}))]}),Object(M.jsx)(W,{state:t,setMessageHandler:n})]})};var J=function(){var e=Object(n.useReducer)(I,{isAuth:!1,name:null,roomId:null,roomIdFromURL:null,messages:[],roomsList:[]}),t=Object(c.a)(e,2),a=t[0],r=t[1];Object(n.useMemo)((function(){var e=document.location.pathname.split("/");3===e.length&&r({type:"SET_ROOM_ID_FROM_URL",payload:e[2]})}),[]);var s=function(e){r({type:"IS_AUTH",payload:e})},o=function(e){r({type:"SET_MESSAGE",payload:e})},_=function(e){r({type:"SET_ROOMS",payload:e})},m=function(e){r({type:"SET_MESSAGES",payload:e})};return Object(n.useEffect)((function(){a.isAuth&&h([a.name,a.roomId]),r({type:"SWITCH_TO_FALSE"})}),[a.isAuth]),Object(n.useEffect)((function(){x(_),g(m),S(o)}),[]),Object(M.jsx)(T.a,{basename:"/ChatOnReactAndNode",children:Object(M.jsxs)("div",{className:i.a.App,children:[null===a.name&&Object(M.jsx)(w.a,{exact:!0,from:"/",to:"/entrance"}),null!==a.name?Object(M.jsx)(w.b,{path:"/roomlist",render:function(){return Object(M.jsx)(z,{onEntrance:s,setMessageHandler:o,state:a})}}):Object(M.jsx)(w.b,{path:"/entrance",render:function(){return Object(M.jsx)(L,{onEntrance:s,roomIdFromURL:a.roomIdFromURL})}})]})})},P=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,130)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,o=t.getTTFB;a(e),n(e),r(e),s(e),o(e)}))};o.a.render(Object(M.jsx)(r.a.StrictMode,{children:Object(M.jsx)(J,{})}),document.getElementById("root")),P()},35:function(e,t,a){e.exports={App:"App_App__1bsEz"}},6:function(e,t,a){e.exports={chat__wrapper:"Chat_chat__wrapper__3zC5l",messages:"Chat_messages__Ui-Ut",message:"Chat_message__3lb-g",text__message:"Chat_text__message__3oRV0",message__info:"Chat_message__info__2NkqB",message__sender:"Chat_message__sender__318ed",message__sent:"Chat_message__sent__n0-mY",form__message:"Chat_form__message__1GMuX",textarea:"Chat_textarea__3-hJN",button__send:"Chat_button__send__3BTaB"}},68:function(e,t,a){e.exports={entrance__wrapper:"Entrance_entrance__wrapper__2Smj2"}},75:function(e,t,a){}},[[129,1,2]]]);
//# sourceMappingURL=main.62fdf61a.chunk.js.map